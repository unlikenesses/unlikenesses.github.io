<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.ebcd1856d9be4c2d6fc8.css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}

/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}a{background-color:transparent}small{font-size:80%}h1,p{margin:0}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}*,:after,:before{box-sizing:border-box;border:0 solid #e2e8f0}h1{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.bg-white{--bg-opacity:1;background-color:#fff;background-color:rgba(255,255,255,var(--bg-opacity))}.bg-gray-100{--bg-opacity:1;background-color:#f7fafc;background-color:rgba(247,250,252,var(--bg-opacity))}.bg-gray-300{--bg-opacity:1;background-color:#e2e8f0;background-color:rgba(226,232,240,var(--bg-opacity))}.hover\:bg-gray-400:hover{--bg-opacity:1;background-color:#cbd5e0;background-color:rgba(203,213,224,var(--bg-opacity))}.rounded{border-radius:.25rem}.flex{display:flex}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-between{justify-content:space-between}.font-bold{font-weight:700}.text-sm{font-size:.875rem}.text-lg{font-size:1.125rem}.text-xl{font-size:1.25rem}.text-3xl{font-size:1.875rem}.text-5xl{font-size:3rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mx-auto{margin-left:auto;margin-right:auto}.mr-3{margin-right:.75rem}.p-6{padding:1.5rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.pt-2{padding-top:.5rem}.pb-3{padding-bottom:.75rem}.pb-5{padding-bottom:1.25rem}.pl-5{padding-left:1.25rem}.pt-6{padding-top:1.5rem}.pb-6{padding-bottom:1.5rem}.shadow{box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06)}.hover\:shadow-md:hover{box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06)}.text-left{text-align:left}.text-gray-600{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.text-gray-700{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.text-pink-600{--text-opacity:1;color:#d53f8c;color:rgba(213,63,140,var(--text-opacity))}.hover\:text-gray-700:hover{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.hover\:text-gray-800:hover{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity))}.uppercase{text-transform:uppercase}.capitalize{text-transform:capitalize}.no-underline{text-decoration:none}.hover\:underline:hover{text-decoration:underline}.w-1\/2{width:50%}.w-full{width:100%}.nunito{font-family:Nunito,sans-serif}p{margin-bottom:.75rem}h2{font-size:1.5rem}h2,h3{font-weight:700}h3{font-size:1.25rem}h4{font-size:1.125rem;font-weight:700}code{--text-opacity:1;color:#ed64a6;color:rgba(237,100,166,var(--text-opacity));--bg-opacity:1;background-color:#fff5f7;background-color:rgba(255,245,247,var(--bg-opacity));border-radius:.375rem;padding-left:.25rem;padding-right:.25rem}pre code{padding-left:0;padding-right:0}a{color:#ed64a6;color:rgba(237,100,166,var(--text-opacity));text-decoration:underline}a,blockquote{--text-opacity:1}blockquote{--border-opacity:1;border-color:#ed64a6;border-color:rgba(237,100,166,var(--border-opacity));border-left-width:4px;padding-left:1rem;margin-bottom:.75rem;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}ul{list-style-type:disc;margin-bottom:.5rem}ol,ul{list-style-position:inside}ol{list-style-type:decimal}</style><meta name="generator" content="Gatsby 2.18.17"/><link href="https://fonts.googleapis.com/css?family=Nunito:400,700" rel="stylesheet"/><link as="script" rel="preload" href="/webpack-runtime-bfa1d77fddc1d660155f.js"/><link as="script" rel="preload" href="/commons-e4d1cf937e8afc4814a6.js"/><link as="script" rel="preload" href="/app-d804ca8346e83b6629a1.js"/><link as="script" rel="preload" href="/styles-7cbd95f2e426d3237055.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-bd0a1059aa1449e2e4b2.js"/><link as="fetch" rel="preload" href="/page-data/2015-06-28-grunting/page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="bg-gray-100 nunito"><div class="container mx-auto flex flex-wrap py-6"><header class="pl-5 pb-6"><a class="font-bold text-gray-700 uppercase hover:text-gray-700 text-5xl no-underline" href="/">Unlikenesses <span class="text-xl">A PHP Developer</span></a><nav><a class="no-underline mr-3 text-gray-600 hover:text-gray-700" href="https://twitter.com/unlikenesses" target="_blank" rel="noopener noreferrer">Twitter</a><a class="no-underline mr-3 text-gray-600 hover:text-gray-700" href="https://github.com/unlikenesses" target="_blank" rel="noopener noreferrer">GitHub</a><a class="no-underline text-gray-600 hover:text-gray-700" href="http://codepen.io/unlikenesses/" target="_blank" rel="noopener noreferrer">CodePen</a></nav></header><section class="w-full flex flex-col items-center px-3"><article class="w-full flex flex-col shadow my-4"><div class="bg-white flex flex-col justify-start p-6"><h1 class="text-3xl font-bold text-gray-700 capitalize">grunting</h1><span class="text-sm pb-3 text-gray-600">28 June, 2015</span><div class="text-gray-700"><p>With a new site coming up I made a few changes to my CodeIgniter CMS (yes, I will move on to Laravel soon) and created a Grunt file to automate the tasks.</p>
<p>The main thing to do was to split my <code>assets</code> folder into two -- <code>src</code> and <code>dist</code>. Previously it was a bit of a mess. I had a <code>bootstrap</code> folder shoved into my <code>assets/css</code> folder (even though it contains a load of other, non-css stuff), <code>ckeditor</code> was plopped into <code>assets/js</code>, basically the whole thing was pretty unstructured. It looked something like this:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">├── assets
|   ├── css
|   |    ├── images
|   |    |   ├── [any images used by the css files] 
|   |    ├── admin.css
|   |    ├── ie.css
|   |    ├── jquery-ui.css
|   |    ├── style.css
|   |    ├── [any plugin css files]
|   ├── js
|   |    ├── ckeditor
|   |    |   ├── [all ckeditors files]
|   |    ├── admin.js
|   |    ├── jquery-ui.js
|   |    ├── jquery.min.js
|   |    ├── script.js
|   |    ├── [any plugin js files]
|   ├── scss
|   |    ├── .sass-cache
|   |    ├── breakpoints
|   |    ├── modules
|   |    ├── partials
|   |    ├── config.rb
|   |    ├── ie.scss
|   |    ├── style.scss
|   ├── images</code></pre></div>
<p>Note that there's no concatenation, no minification going on here. The <code>css</code> and <code>js</code> folders could theoretically be swollen with plugins, making them hard to read and of course making for lots of server requests on the website. The images were also not optimized.</p>
<p>So, last week, with a few tutorials and videos to help me out (this <a href="https://scotch.io/tutorials/a-simple-guide-to-getting-started-with-grunt">Scotch.io tutorial</a> was particularly helpful), I set about gruntifying this. Since I already had node, npm and grunt installed (together with a few grunt generators), it was a relatively smooth process.</p>
<p>The first thing I did after <code>cd</code>ing into my folder was create the <code>package.json</code> file with <code>npm init</code>. I then added the plugins I was going to use in the <code>devDependencies</code> section. I needed to optimize images, lint my JS, concatenate and minify my JS, compile my SASS and minify the resultant CSS, and have Grunt watch the CSS and JS files for changes. This was my <code>devDependencies</code> section:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"grunt"</span><span class="token operator">:</span> <span class="token string">"^0.4.5"</span><span class="token punctuation">,</span>
    <span class="token property">"grunt-contrib-cssmin"</span><span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>
    <span class="token property">"grunt-contrib-imagemin"</span><span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>
    <span class="token property">"grunt-contrib-jshint"</span><span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>
    <span class="token property">"grunt-contrib-sass"</span><span class="token operator">:</span> <span class="token string">"^0.9.2"</span><span class="token punctuation">,</span>
    <span class="token property">"grunt-contrib-uglify"</span><span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>
    <span class="token property">"grunt-contrib-watch"</span><span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>
    <span class="token property">"jshint-stylish"</span><span class="token operator">:</span> <span class="token string">"latest"</span>
  <span class="token punctuation">}</span></code></pre></div>
<p>After that running <code>npm install</code> installs the appropriate dependencies. The next step was to create the <code>Gruntfile.js</code> file, but before I could do that I needed to think what from a purely logical point of view would be the most convenient structure for my assets. I'm not convinced I've come up with the optimal solution, but for now I decided upon a layout like this:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">├── assets
|   ├── src
|   |    ├── css
|   |    |   ├── images
|   |    |   ├── ie.css
|   |    |   ├── jquery-ui.css
|   |    |   ├── style.css
|   |    ├── js
|   |    |   ├── vendor
|   |    |   |   ├── jquery.min.js
|   |    |   |   ├── jquery-ui.js
|   |    |   ├── admin.js
|   |    |   ├── script.js
|   |    ├── scss
|   |    |   ├── [As aboveundefined but without the config.rb file]
|   |    ├── images
|   ├── dist
|   |    ├── css
|   |    ├── images
|   |    ├── js
|   ├── ckeditor</code></pre></div>
<p>So at the beginning, the <code>dist</code> subfolders - <code>css</code>, <code>images</code> and <code>js</code> - are empty. I also put a <code>vendor</code> folder in the <code>src/js</code> folder - this made it easier to target when created the <code>vendor.js</code> file in <code>dist</code>. With this decided on, I put together the <code>Gruntfile.js</code> with a bit of help from various tuts on and off youtube. </p>
<p>This was all pretty straightforward. A few wrinkles included: </p>
<ul>
<li>First trying out the Grunt <a href="https://github.com/gruntjs/grunt-contrib-compass">Compass</a> plugin, and being too impatient to figure out the various config options, which led me to go for the simpler <a href="https://github.com/gruntjs/grunt-contrib-sass">SASS</a> plugin.</li>
<li>Confusing myself over the question of whether to concat first then minify or vice versa. Using the <a href="https://github.com/gruntjs/grunt-contrib-concat">Concat</a> plugin at first before realising that I could concatenate with the <a href="https://github.com/gruntjs/grunt-contrib-uglify">Uglify</a> plugin which I was using anyway.</li>
<li>Having problems with <a href="https://github.com/gruntjs/grunt-contrib-jshint">JSHint</a> grumbling at some of my vendor JS files. I ended up excluding them from the <code>jshint</code> build step.</li>
</ul>
<p>I won't post the whole <code>Gruntfile.js</code> file here, because (a) it's long and (b) it's probably very similar to a thousand other configs out in the wild. Just look at any tutorial for hints. I will post a couple of things that relate to my 'wrinkles' above. For example, the JSHint section, with its exclusion of vendor files, ended up looking like this:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json">jshint<span class="token operator">:</span> <span class="token punctuation">{</span>
	options<span class="token operator">:</span> <span class="token punctuation">{</span>
		reporter<span class="token operator">:</span> require('jshint-stylish')
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	build<span class="token operator">:</span> <span class="token punctuation">[</span>'Gruntfile.js'<span class="token punctuation">,</span>'assets/src/js<span class="token comment">/*.js','!assets/src/js/vendor/*']
		}</span></code></pre></div>
<p>And my Uglify section - concatenating and uglifying at the same time - looks like this:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json">uglify<span class="token operator">:</span> <span class="token punctuation">{</span>
	options<span class="token operator">:</span> <span class="token punctuation">{</span>
		banner<span class="token operator">:</span> '<span class="token comment">/*\n &lt;%= pkg.name %> &lt;%= grunt.template.today(</span><span class="token string">"yyyy-mm-dd"</span>) %> \n*/\n'
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	build<span class="token operator">:</span> <span class="token punctuation">{</span>
		files<span class="token operator">:</span> <span class="token punctuation">{</span>
			'assets/dist/js/vendor.js'<span class="token operator">:</span>'assets/src/js/vendor<span class="token comment">/*.js',
			'assets/dist/js/main.js': 'assets/src/js/script.js',
			'assets/dist/js/admin.js': ['assets/src/js/admin.js','assets/src/js/app.js','assets/src/js/jquery.Jcrop.min.js','assets/src/js/pGenerator.jquery.js']	
		}
	}
}</span></code></pre></div>
<p>Note there's a few JS files being glued into one <code>admin.js</code> file, and everything in the <code>vendor</code> folder ends up as <code>vendor.js</code>.</p>
<p>To cap it all I've got the <a href="https://github.com/gruntjs/grunt-contrib-watch">Watch</a> plugin training its beady eyes on my CSS and JS files, and running SASS, CSSMin, JSHint and Uglify whenever they change.</p>
<p>So that's it! Obviously I had to change some of the references in my CMS code to point to the new <code>assets/dist</code> folder and its various subfolders / files, but apart from that this was a remarkably smooth process and I end up with smaller files and fewer trips to the server. </p></div></div></article><div class="w-full flex pt-6"><a class="w-1/2 bg-white shadow hover:shadow-md text-left p-6 no-underline" href="/2015-07-27-git-ftp/"><p class="text-lg text-gray-700 font-bold flex items-center">Next<!-- -->:</p><p class="pt-2 capitalize">Git FTP<!-- --> <small>27 July, 2015</small></p></a></div></section></div><footer class="container mx-auto flex flex-wrap py-4 px-5 justify-between text-gray-600"><p>Unlikenesses</p><p>Built with <a href="https://www.gatsbyjs.org" target="_blank">GatsbyJS</a> and <a href="https://tailwindcss.com" target="_blank">Tailwind CSS</a></p></footer></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2015-06-28-grunting/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-d804ca8346e83b6629a1.js"],"component---src-templates-index-js":["/component---src-templates-index-js-92417d065a18fc883335.js"],"component---src-templates-post-js":["/component---src-templates-post-js-bd0a1059aa1449e2e4b2.js"],"component---src-pages-404-js":["/component---src-pages-404-js-224a4a61ab9775ba900d.js"]};/*]]>*/</script><script src="/component---src-templates-post-js-bd0a1059aa1449e2e4b2.js" async=""></script><script src="/styles-7cbd95f2e426d3237055.js" async=""></script><script src="/app-d804ca8346e83b6629a1.js" async=""></script><script src="/commons-e4d1cf937e8afc4814a6.js" async=""></script><script src="/webpack-runtime-bfa1d77fddc1d660155f.js" async=""></script></body></html>