<!DOCTYPE html>
 <html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-js-7df041701cf4f91df84f.js" as="script"/><link rel="preload" href="/component---src-templates-post-js-76dc69f022ab826f0635.js" as="script"/><link rel="preload" href="/path---2015-12-16-backbone-todo-tutorial-part-one-a1611070540c6d3ca3e2.js" as="script"/><link rel="preload" href="/app-6401533e476656f79779.js" as="script"/><link rel="preload" href="/commons-c98b01152894ae2b67c3.js" as="script"/><script id="webpack-manifest">
            //<![CDATA[
            window.webpackManifest = {"231608221292675":"app-6401533e476656f79779.js","104101334113578":"component---src-templates-index-js-6d2a4423a0248e33c079.js","195351340454287":"component---src-templates-post-js-76dc69f022ab826f0635.js","96961042003272":"component---src-templates-page-js-d5c0e705de1e6e4de7ac.js","162898551421021":"component---src-pages-404-js-d531b70477459f1814e4.js","60335399758886":"path----0f20a0fc9d4a46d1823e.js","142629428675168":"path---index-1a857483eec1556fb512.js","157285553617042":"path---2-d4ef60c33c9f363db8f1.js","182981024786761":"path---3-bbd38557da8d69092815.js","24461200302109":"path---4-179fed329595a8182547.js","81823991089174":"path---5-3785c571d49d75b0dbab.js","161064502438360":"path---6-311582f93b45546e6b57.js","135192265913235":"path---7-d0573a257e3cec35af7b.js","124787695326054":"path---8-1c58748466cf3b2827c1.js","213466077792436":"path---9-904c81641129d5cc7f84.js","9808220947040":"path---2018-03-24-laracasts-lessons-b3839c423211d3333fc5.js","84909672733991":"path---2018-02-20-http-components-58bf125da37901317cd8.js","65703697086429":"path---2017-11-06-migrating-blog-to-gatsby-2dd1e4582c39adc0655d.js","82159097398771":"path---2017-08-10-jwts-with-react-and-laravel-9fa92a2c75f9ed4cf872.js","42858671310536":"path---2017-07-31-redux-with-local-storage-494fec0005c999965f77.js","260890707284528":"path---2017-07-19-rails-on-windows-with-vagrant-c57d1b20c8eebeb7102c.js","38482880249802":"path---2017-07-18-laravel-and-react-288fa008121629940d0c.js","195319379033395":"path---2017-07-14-react-sequencer-redux-bc6dc982e0b8342a1131.js","112315994342886":"path---2017-07-05-react-sequencer-01198608e3a49aa48f51.js","268830554003963":"path---2017-06-29-vue-loader-modals-fed1c6ca205ad37efa17.js","279153020621834":"path---2017-06-22-git-forgetfulness-663a4b1557a8cb1295ad.js","276809233923553":"path---2017-06-21-vue-transitions-ef4008d05480f1750ad9.js","31086155586662":"path---2017-06-12-multiple-remotes-182e704e307b2fbab9cc.js","177989185540973":"path---2017-04-04-understanding-react-43b1e40c4f55a1628e28.js","174035726735906":"path---2017-02-19-laravel-artisan-create-crud-8ee5d2cb69a9213f2b59.js","181250746654499":"path---2016-03-12-laravel-on-fasthosts-ac78842520e4bd31d111.js","4684662507324":"path---2016-02-20-mp-info-b196533debc22059fc42.js","218487729792812":"path---2015-12-17-backbone-todo-tutorial-part-two-d48cade4b09359ec12b3.js","227955374642705":"path---2015-12-16-backbone-todo-tutorial-part-one-a1611070540c6d3ca3e2.js","203214790603947":"path---2015-10-22-tanking-137eb6db27fc1c612dcb.js","32735643032460":"path---2015-10-09-soft-cascading-6a47bf56590d6f18204f.js","83046412945820":"path---2015-09-06-literally-literals-5606a47b37879c37ded8.js","109709943139863":"path---2015-08-17-glossy-47eba200e21eaecb12e4.js","32773584370824":"path---2015-07-29-commentment-f2fb61c5d191dd84ffaf.js","192318839099629":"path---2015-07-27-kicking-against-the-gits-38190fbd87dd16f8618a.js","18427234579038":"path---2015-06-28-grunting-b07e6e53888f4759898e.js","69790250895867":"path---experiments-6fb98fb9139180136091.js","273950069227526":"path---about-06ea1e126b2fec72d301.js","254022195166212":"path---404-1db04e5021b40904aca6.js","178698757827068":"path---404-html-1db04e5021b40904aca6.js","114276838955818":"component---src-layouts-index-js-7df041701cf4f91df84f.js"}
            //]]>
            </script><link href="https://fonts.googleapis.com/css?family=Roboto+Slab:700|Noto+Serif:400,400i,700,700i" rel="stylesheet"/><script>
  !function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",[
  "/commons-c98b01152894ae2b67c3.js","/app-6401533e476656f79779.js","/path---2015-12-16-backbone-todo-tutorial-part-one-a1611070540c6d3ca3e2.js","/component---src-templates-post-js-76dc69f022ab826f0635.js","/component---src-layouts-index-js-7df041701cf4f91df84f.js"
])
  </script><style id="gatsby-inlined-css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}*{box-sizing:border-box}body,html{margin:0;padding:0}html{font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:16px;line-height:1.5}@media (min-width:38em){html{font-size:20px}}body{color:#515151;background-color:#fff;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}a{color:#268bd2;text-decoration:none}a strong{color:inherit}a:focus,a:hover{text-decoration:underline}h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:700;line-height:1.25;color:#313131;text-rendering:optimizeLegibility}h1{font-size:2rem}h2{margin-top:1rem;font-size:1.5rem}h3{margin-top:1.5rem;font-size:1.25rem}h4,h5,h6{margin-top:1rem;font-size:1rem}p{margin-top:0;margin-bottom:1rem}strong{color:#303030}dl,ol,ul{margin-top:0;margin-bottom:1rem}dt{font-weight:700}dd{margin-bottom:.5rem}hr{position:relative;margin:1.5rem 0;border:0;border-top:1px solid #eee;border-bottom:1px solid #fff}abbr{font-size:85%;font-weight:700;color:#555;text-transform:uppercase}abbr[title]{cursor:help;border-bottom:1px dotted #e5e5e5}code,pre{font-family:Menlo,Monaco,Courier New,monospace}code{padding:.25em .5em;font-size:85%;color:#bf616a;border-radius:3px}code,pre{background-color:#f9f9f9}pre{display:block;margin-top:0;margin-bottom:1rem;padding:1rem;font-size:.8rem;line-height:1.4;white-space:pre;white-space:pre-wrap;word-break:break-all;word-wrap:break-word}pre code{padding:0;font-size:100%;color:inherit;background-color:transparent}.highlight{margin-bottom:1rem;border-radius:4px}.highlight pre{margin-bottom:0}.gist .gist-file{font-family:Menlo,Monaco,Courier New,monospace!important}.gist .markdown-body{padding:15px}.gist pre{padding:0;background-color:transparent}.gist .gist-file .gist-data{font-size:.8rem!important;line-height:1.4}.gist code{padding:0;color:inherit;background-color:transparent;border-radius:0}blockquote{padding:.5rem 1rem;margin:.8rem 0;color:#7a7a7a;border-left:.25rem solid #e5e5e5}blockquote p:last-child{margin-bottom:0}@media (min-width:30em){blockquote{padding-right:5rem;padding-left:1.25rem}}img{display:block;max-width:100%;margin:0 0 1rem;border-radius:5px}table{margin-bottom:1rem;width:100%;border:1px solid #e5e5e5;border-collapse:collapse}td,th{padding:.25rem .5rem;border:1px solid #e5e5e5}tbody tr:nth-child(odd) td,tbody tr:nth-child(odd) th{background-color:#f9f9f9}.lead{font-size:1.25rem;font-weight:300}.message{margin-bottom:1rem;padding:1rem;color:#717171;background-color:#f9f9f9}.container{max-width:38rem;padding-left:1rem;padding-right:1rem;margin-left:auto;margin-right:auto}.masthead{padding-top:1rem;padding-bottom:1rem;margin-bottom:3rem}.masthead-title{margin-top:0;margin-bottom:0;color:#505050}.masthead-title a{color:#505050}.masthead-title small{font-size:75%;font-weight:400;color:silver;letter-spacing:0}.page,.post{margin-bottom:4em}.page-title,.post-title,.post-title a{color:#303030}.page-title,.post-title{margin-top:0}.post-date{display:block;margin-top:-.5rem;margin-bottom:1rem;color:#9a9a9a}.related{padding-top:2rem;padding-bottom:2rem;border-top:1px solid #eee}.related-posts{padding-left:0;list-style:none}.related-posts h3{margin-top:0}.related-posts li small{font-size:75%;color:#999}.related-posts li a:hover{color:#268bd2;text-decoration:none}.related-posts li a:hover small{color:inherit}.pagination{overflow:hidden;margin-left:-1rem;margin-right:-1rem;font-family:PT Sans,Helvetica,Arial,sans-serif;color:#ccc;text-align:center}.pagination-item{display:block;padding:1rem;border:1px solid #eee}.pagination-item:first-child{margin-bottom:-1px}a.pagination-item:hover{background-color:#f5f5f5}@media (min-width:30em){.pagination{margin:3rem 0}.pagination-item{float:left;width:50%}.pagination-item:first-child{margin-bottom:0;border-top-left-radius:4px;border-bottom-left-radius:4px}.pagination-item:last-child{margin-left:-1px;border-top-right-radius:4px;border-bottom-right-radius:4px}}html{font-family:Noto Serif,Georgia,serif}@media (min-width:48em){html{font-size:16px}}@media (min-width:58em){html{font-size:17px;line-height:1.75}}.sidebar{font-family:Roboto Slab,Helvetica,Arial,sans-serif;text-align:center;padding:2rem 1rem;color:hsla(0,0%,100%,.5);background-color:#202020}@media (min-width:48em){.sidebar{position:fixed;top:0;left:0;bottom:0;width:18rem;text-align:left}}.sidebar a{color:#fff}.sidebar-about h1{color:#fff;margin-top:0;font-size:2.25rem}.sidebar-nav{margin-bottom:1rem}.sidebar-nav-item{display:block;line-height:1.75}a.sidebar-nav-item:focus,a.sidebar-nav-item:hover{text-decoration:underline}.sidebar-nav-item.active{font-weight:700}@media (min-width:48em){.sidebar-sticky{position:absolute;right:1rem;bottom:1rem;left:1rem}}.content{padding-top:4rem;padding-bottom:4rem}@media (min-width:48em){.content{max-width:38rem;margin-left:20rem;margin-right:2rem}}@media (min-width:64em){.content{margin-left:22rem;margin-right:4rem}}@media (min-width:48em){.layout-reverse .sidebar{left:auto;right:0}.layout-reverse .content{margin-left:2rem;margin-right:20rem}}@media (min-width:64em){.layout-reverse .content{margin-left:4rem;margin-right:22rem}}.page-title,.post-title,h2,h3,h4{font-family:Roboto Slab,Helvetica,Arial,sans-serif;text-transform:capitalize}.post-title{font-size:2rem}.theme-base-08 .sidebar{background-color:#ac4142}.theme-base-08 .content a,.theme-base-08 .related-posts li a:hover{color:#ac4142}.theme-base-09 .sidebar{background-color:#d28445}.theme-base-09 .content a,.theme-base-09 .related-posts li a:hover{color:#d28445}.theme-base-0a .sidebar{background-color:#f4bf75}.theme-base-0a .content a,.theme-base-0a .related-posts li a:hover{color:#f4bf75}.theme-base-0b .sidebar{background-color:#90a959}.theme-base-0b .content a,.theme-base-0b .related-posts li a:hover{color:#90a959}.theme-base-0c .sidebar{background-color:#75b5aa}.theme-base-0c .content a,.theme-base-0c .related-posts li a:hover{color:#75b5aa}.theme-base-0d .sidebar{background-color:#6a9fb5}.theme-base-0d .content a,.theme-base-0d .related-posts li a:hover{color:#6a9fb5}.theme-base-0e .sidebar{background-color:#aa759f}.theme-base-0e .content a,.theme-base-0e .related-posts li a:hover{color:#aa759f}.theme-base-0f .sidebar{background-color:#8f5536}.theme-base-0f .content a,.theme-base-0f .related-posts li a:hover{color:#8f5536}#mc_embed_signup form{display:block;position:relative;text-align:left;padding:10px 0 10px 3%}#mc_embed_signup h2{font-weight:700;padding:0;margin:15px 0;font-size:1.4em}#mc_embed_signup input{border:1px solid #999;-webkit-appearance:none}#mc_embed_signup input[type=checkbox]{-webkit-appearance:checkbox}#mc_embed_signup input[type=radio]{-webkit-appearance:radio}#mc_embed_signup input:focus{border-color:#333}#mc_embed_signup .button{clear:both;background-color:#aaa;border:0 none;border-radius:4px;letter-spacing:.03em;color:#fff;cursor:pointer;display:inline-block;font-size:15px;height:32px;line-height:32px;margin:0 5px 10px 0;padding:0;text-align:center;text-decoration:none;vertical-align:top;white-space:nowrap;width:auto;transition:all .23s ease-in-out 0s}#mc_embed_signup .button:hover{background-color:#777}#mc_embed_signup .small-meta{font-size:11px}#mc_embed_signup .nowrap{white-space:nowrap}#mc_embed_signup .clear{clear:none;display:inline}#mc_embed_signup label{display:block;font-size:16px;padding-bottom:10px;font-weight:700}#mc_embed_signup input.email{font-family:Open Sans,Helvetica Neue,Arial,Helvetica,Verdana,sans-serif;font-size:15px;display:block;padding:0 .4em;margin:0 4% 10px 0;min-height:32px;width:58%;min-width:130px;border-radius:3px}#mc_embed_signup input.button{display:block;width:35%;margin:0 0 10px;min-width:90px}#mc_embed_signup div#mce-responses{float:left;top:-1.4em;padding:0 .5em;overflow:hidden;width:90%;margin:0 5%;clear:both}#mc_embed_signup div.response{margin:1em 0;padding:1em .5em .5em 0;font-weight:700;float:left;top:-1.5em;z-index:1;width:80%}#mc_embed_signup #mce-error-response{display:none}#mc_embed_signup #mce-success-response{color:#529214;display:none}#mc_embed_signup label.error{display:block;float:none;width:auto;margin-left:1.05em;text-align:left;padding:.5em 0}#mc_embed_signup{clear:left;font-size:14px}#mc_embed_signup input{border:1px solid hsla(0,0%,100%,.5)}#mc_embed_signup input.email{width:100%;font-family:Roboto Slab,Helvetica,Arial,sans-serif}#mc_embed_signup form{padding-left:0}#mc_embed_signup input.button{width:50%}#mc_embed_signup .button{background-color:hsla(0,0%,100%,.5);font-family:Roboto Slab,Helvetica,Arial,sans-serif;color:#ac4142}#mc_embed_signup .button:hover{background-color:#fff}</style></head><body><div id="___gatsby"><div class="theme-base-08" data-reactroot="" data-reactid="1" data-react-checksum="544981348"><div class="sidebar" data-reactid="2"><div class="container sidebar-sticky" data-reactid="3"><div class="sidebar-about" data-reactid="4"><h1 data-reactid="5"><a href="/" data-reactid="6">Unlikenesses</a></h1><p class="lead" data-reactid="7"></p></div><nav class="sidebar-nav" data-reactid="8"><a class="sidebar-nav-item" href="/" data-reactid="9">Blog</a><a class="sidebar-nav-item" href="/about/" data-reactid="10">About</a><a class="sidebar-nav-item" href="/experiments/" data-reactid="11">Experiments</a><a class="sidebar-nav-item" href="https://twitter.com/unlikenesses" target="_blank" data-reactid="12">Twitter</a><a class="sidebar-nav-item" href="https://github.com/unlikenesses" target="_blank" data-reactid="13">Github</a><a class="sidebar-nav-item" href="http://codepen.io/unlikenesses/" target="_blank" data-reactid="14">Codepen</a></nav><div id="mc_embed_signup" data-reactid="15"><form action="//unlikenesses.us16.list-manage.com/subscribe/post?u=10d0fb49bc331ab8668b0fa14&amp;id=786a57e78d" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="" data-reactid="16"><div id="mc_embed_signup_scroll" data-reactid="17"><label for="mce-EMAIL" data-reactid="18">Subscribe for updates</label><input type="email" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required="" data-reactid="19"/><div style="position:absolute;left:-5000px;" aria-hidden="true" data-reactid="20"><input type="text" name="b_10d0fb49bc331ab8668b0fa14_786a57e78d" tabindex="-1" data-reactid="21"/></div><div class="clear" data-reactid="22"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button" data-reactid="23"/></div></div></form></div><p data-reactid="24"><!-- react-text: 25 -->© <!-- /react-text --><!-- react-text: 26 -->2018<!-- /react-text --></p></div></div><div class="content container" data-reactid="27"><div data-reactid="28"><div class="post" data-reactid="29"><h1 class="post-title" data-reactid="30">backbone todo tutorial part one</h1><span class="post-date" data-reactid="31">16 December, 2015</span><div data-reactid="32"><h3>Based on <a href="http://addyosmani.github.io/backbone-fundamentals/#exercise-1-todos---your-first-backbone.js-app">Todos - Your First Backbone.js App</a></h3>
<h4>From the book <a href="http://addyosmani.github.io/backbone-fundamentals/">Developing Backbone.js Applications</a> by <a href="https://twitter.com/addyosmani">Addy Osmani</a></h4>
<h4>Rationale</h4>
<p>Addy Osmani's book <a href="http://addyosmani.github.io/backbone-fundamentals/">Developing Backbone.js Applications</a>, an open-source guide to <a href="http://backbonejs.org/">Backbone.js</a> (though you can also <a href="http://shop.oreilly.com/product/0636920025344.do">buy it from O'Reilly</a>) contains a number of tutorials that help massively with learning this framework. But as I was working through them I found that I was suffering from an overload of information. Even with an app as simple as a Todo list, I found myself wishing that instead of presenting me with a large chunk of code in one go, the tutorial would go through the app incrementally, first creating all the necessary code for one function, then adding new functions step by step. </p>
<p>At the same time, no other guide I could find was able to present the concepts of Backbone.js with the clarity and authority of Developing Backbone.js Applications. So rather than throwing my hands up and searching wildly for a poorly-narrated tutorial recorded in a damp, echoey bedroom and uploaded to Youtube, I thought it might be a better idea to break down this app into smaller pieces, and in the process keep a record of it all here. </p>
<p>So for anyone else who, like me, is coming late to the Backbone.js party and is having trouble finding an authoritative code example (Addy Osmani's) presented with a Backbone-for-Dummies simplicity (dummy==me), this page might be of some help. Of course it's no substitute for reading the <a href="http://addyosmani.github.io/backbone-fundamentals/">book</a> itself, to which all credit is due for every line of the code that follows in this tutorial. Thanks to Addy Osmani for writing it, and for making it open source. </p>
<h4>1: The HTML</h4>
<p>I'm going to assume you have read the <a href="http://addyosmani.github.io/backbone-fundamentals/#introduction">Introduction</a>, <a href="http://addyosmani.github.io/backbone-fundamentals/#fundamentals">Fundamentals</a> and <a href="http://addyosmani.github.io/backbone-fundamentals/#backbone-basics">Backbones Basics</a> chapters of Developing Backbone.js Applications. This means that you'll have an awareness of the MVC methodology, as well as some idea of how it's implemented in Backbone.js. You'll know, at least in theory, the roles played by views, controllers, models, collections, and routers; you'll also have a glancing familiarity with <a href="http://underscorejs.org/">Underscore.js</a>.</p>
<p>This part will begin building the Todo app that forms the basis of the <a href="http://addyosmani.github.io/backbone-fundamentals/#exercise-1-todos---your-first-backbone.js-app">first tutorial</a> in Addy Osmani's book. If you had no trouble following that chapter, then it's safe to assume this blog isn't for you. Otherwise, let's crack on. </p>
<p>In the rest of this guide I'll be using the exact same code Osmani wrote for his tutorial, but I'll be splitting it up into smaller, more manageable chunks, and offering my own explanations along the way. Apart from the code, all the text in this guide is my own, and I alone am responsible for any mistakes or misinterpretations it contains. Before going any further, I'll make my first and last (well, almost-last) quote from Osmani's book: these are the constituents of what he calls the "application's architecture at a high level":</p>
<blockquote>
<ul>
<li>a Todo model to describe individual todo items</li>
<li>a TodoList collection to store and persist todos</li>
<li>a way of creating todos</li>
<li>a way to display a listing of todos</li>
<li>a way to edit existing todos</li>
<li>a way to mark a todo as completed</li>
<li>a way to delete todos</li>
<li>a way to filter the items that have been completed or are remaining</li>
</ul>
</blockquote>
<p>What confused me when I first went through this tutorial was that it often tried to fit all of these functions into one chunk of code. What will happen here is we will start off with just the bare-bones functionality. The footer, status, storage, and filter elements will be left to later.</p>
<p>So let's make a start. We'll begin with the HTML, but slightly simplified:</p>
<div class="gatsby-highlight">
      <pre class="language-html"><code><span class="token doctype">&lt;!doctype html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>IE=edge,chrome=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Backbone.js • TodoMVC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>assets/css/style.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/template<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item-template<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/lib/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/lib/underscore-min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/lib/backbone-min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/models/todo.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/collections/todos.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/views/todos.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/views/app.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/app.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
      </div>
<p>Notice the file structure here: a root folder, containing a single folder, <code>js</code>. This contains a <code>lib</code> folder, containing our dependencies (jQuery, Underscore.js and Backbone.js), along with four folders to contain the Backbone.js files, <code>views</code>, <code>models</code>, <code>collections</code>, and <code>routers</code>. There's also a file <code>app.js</code> in the <code>js</code> root.</p>
<p>Osmani next fills in some of the <code>&#x3C;body></code> of this page; we'll do the same, but using a stripped-back version:</p>
<div class="gatsby-highlight">
      <pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>todoapp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>todos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>new-todo<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>What needs to be done?<span class="token punctuation">"</span></span> <span class="token attr-name">autofocus</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>main<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>todo-list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span>
</code></pre>
      </div>
<p>Stripping out the footer and info sections, we're left with an <code>&#x3C;input></code> tag to create the next todo, and a <code>&#x3C;ul></code> list to contain existing todos.</p>
<p>Lastly for this page, there's the template that will hold each individual todo. We won't bother with the stats template for now:</p>
<div class="gatsby-highlight">
      <pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/template<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item-template<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"view"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>input <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"toggle"</span> type<span class="token operator">=</span><span class="token string">"checkbox"</span> <span class="token operator">&lt;</span><span class="token operator">%=</span> completed <span class="token operator">?</span> <span class="token string">'checked'</span> <span class="token punctuation">:</span> <span class="token string">''</span> <span class="token operator">%</span><span class="token operator">>></span>
    <span class="token operator">&lt;</span>label<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">%=</span> title <span class="token operator">%</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token operator">&lt;</span>input <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"edit"</span> value<span class="token operator">=</span><span class="token string">"&lt;%= title %>"</span><span class="token operator">></span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
      </div>
<h4>2: The Model</h4>
<p>This is the Todo model. Remember, a model represents a single data object. In our case, it contains a title and a flag to specify whether or not the todo has been completed:</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> app <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Todo Model</span>
<span class="token comment">// ----------</span>

app<span class="token punctuation">.</span>Todo <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>Model<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

  defaults<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    completed<span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>Most of this is pretty straightforward, but some of it could do with some unpacking. For a start, what's that line at the start? </p>
<div class="gatsby-highlight">
      <pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> app <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>This defines the variable <code>app</code> to be an empty object (<code>{}</code>) if it is not already defined. It takes advantage of the way that Javascript interprets the <code>||</code> (OR) operator. If the left hand side is TRUE, that will be returned (i.e. if <code>app</code> is already defined, <code>app</code> will continue to refer to what <code>app</code> was referring to before...); otherwise (if <code>app</code> is not already defined, and therefore if the left hand side of the <code>||</code> operator is false), the right hand side will be returned, in which case <code>app</code> will be set to <code>{}</code>, or an empty object. Basically, this line checks to see if the namespace <code>app</code> already exists, and if it doesn't, creates it.</p>
<h4>3: The Collection</h4>
<p>Remember the Todo model represents a <em>single</em> todo. Any todo list needs to contain multiple todos, which we will store in a collection. Here's a stripped-back collection code:</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> app <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Todo Collection</span>
<span class="token comment">// ---------------</span>

<span class="token keyword">var</span> TodoList <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>Collection<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

  model<span class="token punctuation">:</span> app<span class="token punctuation">.</span>Todo<span class="token punctuation">,</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create our global collection of **Todos**.</span>
app<span class="token punctuation">.</span>Todos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TodoList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>This could not be simpler: it specifies that the model collected by this collection is <code>Todo</code>, in the namespace <code>app</code>.</p>
<p>The last line creates a new collection and stores it in the variable <code>Todos</code>. Pay attention to this -- it will be referred to elsewhere in the code. If it helps, think of it as the main data structure for the entire app. When we make a <code>create</code> call later (as we shall see) it will be <code>app.Todos</code> that is being called.</p>
<h4>4: The Application View (Part One)</h4>
<p>This is a biggy, and Osmani splits it into two sections. As usual, I'm going to give you a minimalized version of it, and we can add more functionality later. Here's the first part:</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> app <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// The Application</span>
<span class="token comment">// ---------------</span>

app<span class="token punctuation">.</span>AppView <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>View<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

  el<span class="token punctuation">:</span> <span class="token string">'#todoapp'</span><span class="token punctuation">,</span>

  initialize<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$input <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#new-todo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">listenTo</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>Todos<span class="token punctuation">,</span> <span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>addOne<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// Add a single todo item to the list by creating a view for it, and</span>
  <span class="token comment">// appending its element to the `&lt;ul>`.</span>
  addOne<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> todo <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> view <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">app<span class="token punctuation">.</span>TodoView</span><span class="token punctuation">(</span><span class="token punctuation">{</span> model<span class="token punctuation">:</span> todo <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#todo-list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span> view<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>el <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>Recall from the earlier section in the book, <a href="http://addyosmani.github.io/backbone-fundamentals/#what-is-el">What is <code>el</code>?</a>, that it <code>el</code> refers to an element in the DOM, and is a necessary component of all views. They can be created and added to the DOM, or an already existing element can be referred to. In our case, we're referring to the <code>id</code> (<code>todoapp</code>) of the <code>section</code> element created in the HTML in our first step.</p>
<p>Next up is the <code>initialize()</code> method. In my version we only set one jQuery variable, <code>this.$input</code>, which we set to the <code>id</code> of the <code>input</code> field we created above in the HTML: <code>&#x3C;input id="new-todo" placeholder="What needs to be done?" autofocus></code>. It's just a convenient way for referencing it later when we come to handling the adding of todos.</p>
<p>There is also a <code>listenTo()</code> binding. It can be a bit confusing here to see where the events are coming from. As the book puts it:</p>
<blockquote>
<p>When an <code>add</code> event is fired the <code>addOne()</code> method is called and passed the new model. </p>
</blockquote>
<p>What is firing the <code>add</code> event? Let's go back to the book, specifically to the <a href="http://addyosmani.github.io/backbone-fundamentals/#events">Events</a> section. Here's our binding again:</p>
<p><code>this.listenTo(app.Todos, 'add', this.addOne);</code></p>
<p>As Osmani puts it, </p>
<blockquote>
<p>While <code>on()</code> and <code>off()</code> add callbacks directly to an observed object, <code>listenTo()</code> tells an object to listen for events on another object</p>
</blockquote>
<p>In our binding, <code>listenTo()</code> tells one object (<code>this</code>) to listen for events on another object (<code>app.Todos</code>). This, recall, is the Collection which I earlier said would be the main focus of the entire app. So we're listening for an <code>add</code> event on the Todos Collection. </p>
<p>But wait! If we go back and look at our Collection, there's no <code>add</code> event there. Where is this coming from? Well, if we look at the Backbone.js <a href="http://backbonejs.org/#Collection-add">manual</a>, we'll see that the <code>add</code> event is baked in to Backbone.js Collections. So this listener is saying: when a model is added to the collection, call <code>this.addOne</code>. (We'll see later what causes the <code>add</code> event to be fired.)</p>
<p>Lastly, the <code>this.addOne()</code> method is pretty simple. First, it creates an instance of the TodoView (which we have not yet coded), then it renders this instance and adds it to the end of the todo list.</p>
<h4>5: The Application View (Part Two)</h4>
<p>In the book, <a href="http://addyosmani.github.io/backbone-fundamentals/#events-and-views">we are reminded</a> to distinguish between two types of events when we are dealing with Views (as we are in this section). One is a DOM event, the other is an event triggered by the Event API. It is this second kind we were dealing with in the previous section. In this section we're going to look at the first kind.</p>
<p>Let's continue with our stripped-down version of <code>views/app.js</code>:</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> app <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// The Application</span>
<span class="token comment">// ---------------</span>

app<span class="token punctuation">.</span>AppView <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>View<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

  el<span class="token punctuation">:</span> <span class="token string">'#todoapp'</span><span class="token punctuation">,</span>

  <span class="token comment">// NEW:</span>
  events<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'keypress #new-todo'</span><span class="token punctuation">:</span> <span class="token string">'createOnEnter'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  initialize<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$input <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#new-todo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">listenTo</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>Todos<span class="token punctuation">,</span> <span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>addOne<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// Add a single todo item to the list by creating a view for it, and</span>
  <span class="token comment">// appending its element to the `&lt;ul>`.</span>
  addOne<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> todo <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> view <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">app<span class="token punctuation">.</span>TodoView</span><span class="token punctuation">(</span><span class="token punctuation">{</span> model<span class="token punctuation">:</span> todo <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#todo-list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span> view<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>el <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// NEW:</span>
  newAttributes<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      title<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$input<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      completed<span class="token punctuation">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// NEW:</span>
  createOnEnter<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> event <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> event<span class="token punctuation">.</span>which <span class="token operator">!==</span> ENTER_KEY <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>$input<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    app<span class="token punctuation">.</span>Todos<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">newAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$input<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>In our basic rewriting of Osmani's code, we only have one new piece of functionality: <code>createOnEnter()</code>. This is called via a DOM event rather than the Events API. As Osmani said in his section on <a href="http://addyosmani.github.io/backbone-fundamentals/#events-and-views">Events and Views</a>, there are two ways two bind DOM events: using a View's <code>events</code> property or using <code>jQuery.on()</code>. Here we're using the <a href="http://backbonejs.org/#View-events"><code>events</code></a> property, which calls the method <code>createOnEnter()</code> whenever there's a <code>keypress</code> in the <code>&#x3C;input></code> field.</p>
<p><code>createOnEnter()</code> itself is pretty simple. After checking that the <code>&#x3C;input></code> text field contains some valid data, it calls the Collection's <code>create()</code> method and clears the field. The object passed to <code>create()</code> is created by this View's <code>newAttributes()</code> method, which simply returns an object with two fields (matching our Model's fields): <code>title</code> and <code>completed</code>. </p>
<p>Remember the <code>add</code> event in the previous section?</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">listenTo</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>Todos<span class="token punctuation">,</span> <span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>addOne<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>We asked what actually triggered this <code>add</code> event. Well, as the Backbone.js <a href="http://backbonejs.org/#Collection-create">manual</a> tells us, it's the Collection's <code>create()</code> method that triggers the <code>add</code> event. So what the code in this View does is: first, add a listener to the input field; second, if the field has some text and the user hits Return, create a new Todo model and add it to the collection; third, create a new view with this model and append it to the list.</p>
<h4>6: The Individual Todo View</h4>
<p>We we actually keep all of the original code for this view. But let's break it down into smaller pieces anyway:</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> app <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Todo Item View</span>
<span class="token comment">// --------------</span>

<span class="token comment">// The DOM element for a todo item...</span>
app<span class="token punctuation">.</span>TodoView <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>View<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

  <span class="token comment">//... is a list tag.</span>
  tagName<span class="token punctuation">:</span> <span class="token string">'li'</span><span class="token punctuation">,</span>
</code></pre>
      </div>
<p>Notice here that instead of creating our <code>el</code> element by associating it with an already existing element in the DOM (as we did with our App View), here it's being created by giving it a <code>tagName</code>, in this case the list item tag.</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code>  <span class="token comment">// Cache the template function for a single item.</span>
  template<span class="token punctuation">:</span> _<span class="token punctuation">.</span><span class="token function">template</span><span class="token punctuation">(</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#item-template'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre>
      </div>
<p>This is simply grabbing the item template we created back in the first section. We're using the Underscore.js <code>_.template()</code> method to convert it to a template.</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code>  <span class="token comment">// The DOM events specific to an item.</span>
  events<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'dblclick label'</span><span class="token punctuation">:</span> <span class="token string">'edit'</span><span class="token punctuation">,</span>
    <span class="token string">'keypress .edit'</span><span class="token punctuation">:</span> <span class="token string">'updateOnEnter'</span><span class="token punctuation">,</span>
    <span class="token string">'blur .edit'</span><span class="token punctuation">:</span> <span class="token string">'close'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
      </div>
<p>As with the App View, this code creates three DOM event bindings with methods in this View.</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code>  <span class="token comment">// The TodoView listens for changes to its model, re-rendering. Since there's</span>
  <span class="token comment">// a one-to-one correspondence between a **Todo** and a **TodoView** in this</span>
  <span class="token comment">// app, we set a direct reference on the model for convenience.</span>
  initialize<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">listenTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">,</span> <span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
      </div>
<p>As Osmani says, this sets up a listener on the Todo Model, which calls a <code>render()</code> method when any change occurs in the Model.</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code>  <span class="token comment">// Re-renders the titles of the todo item.</span>
  render<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">template</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span>attributes <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$input <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.edit'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
      </div>
<p>And here we have the <code>render()</code> function. It sets the <code>html</code> attribute of our <code>el</code> element (remember that's the <code>&#x3C;li></code> tag) to the contents of our template. If we look back at our HTML, we'll see the template has two attributes, <code>title</code> and <code>completed</code>, which are filled in by our call to the template with <code>this.model.attributes</code>. The second line then creates a variable <code>this.$input</code> which refers to the element in the template which has the class <code>edit</code>. Looking back at the HTML we can see that this is the <code>&#x3C;input></code> text field.</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code>  <span class="token comment">// Switch this view into `"editing"` mode, displaying the input field.</span>
  edit<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'editing'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$input<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
      </div>
<p>Casting our eyes up for a second to our <code>events</code> property, we'll see that this <code>edit()</code> method is called when a <code>&#x3C;label></code> element is double-clicked. All this simple method does is add a CSS class to our template and set the focus to its <code>&#x3C;input></code> text field.</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code>  <span class="token comment">// Close the `"editing"` mode, saving changes to the todo.</span>
  close<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$input<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span> value <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token punctuation">:</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'editing'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
      </div>
<p><code>close()</code> is called when the element with the class <code>edit</code> (which is our <code>&#x3C;input></code> text field) loses focus. Here we grab the value of the field, and save it using the model's <code>save()</code> method. Finally, we remove the <code>editing</code> CSS class.</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code>  <span class="token comment">// If you hit `enter`, we're through editing the item.</span>
  updateOnEnter<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> e <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> e<span class="token punctuation">.</span>which <span class="token operator">===</span> ENTER_KEY <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p><code>updateOnEnter()</code> just calls <code>close()</code> when the user hits Enter in the <code>&#x3C;input></code> text field.</p>
<h4>7: Startup</h4>
<p>We now come to <code>js/app.js</code>, where we simply instantiate the root <code>AppView</code>:</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> app <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ENTER_KEY <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>

<span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">new</span> <span class="token class-name">app<span class="token punctuation">.</span>AppView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>The <code>ENTER_KEY</code> constant is used in the Todo View above (in the <code>updateOnEnter()</code> method).</p>
<h4>8: In Action</h4>
<p>At this point the book pauses to try out the app so far, so that's what we'll do too. Open your browser (preferably Chrome) to the index.html page, and open its console. Ideally there'll be no console errors.</p>
<p>One thing you'll notice is that the CSS doesn't seem to be rendering properly. This is because of an error in the CSS supplied with the book. You'll notice, for example, that it refers to <code>.todoapp</code>, where in fact (since <code>todoapp</code> is the <code>id</code> of an element, not the <code>class</code>) it should refer to <code>#todoapp</code>. The same applies to <code>.new-todo</code>, <code>.main</code>, <code>.toggle-all</code>, <code>.todo-list</code>, <code>.footer</code>, <code>.todo-count</code>, <code>.filters</code>, <code>.clear-completed</code>, and <code>.info</code>. So if you want it to look the same as the tutorial, you'll need to do a search and replace on all these items in the CSS file (searching for <code>.[selector]</code> and replacing with <code>#[selector]</code>).</p>
<p>Now you should be able to type something in the large text field at the top, and hit Enter to see it appear in the list underneath. Note that ticking the box next to the newly-added entry, or clicking the Close icon, won't do anything yet. </p>
<p>One thing you will see if you look in the console is an error:</p>
<blockquote>
<p>Uncaught Error: A "url" property or function must be specified</p>
</blockquote>
<p>If you've been following the book's tutorial, this won't appear. But it does for us because in my simplified version I've temporarily ignored anything to do with saving or persisting the todo list. You'll see this if you add a few items and then refresh the page: the list will disappear. The error appears because I haven't removed the <code>save()</code> methods from my version of the code. You can see them in the Model:</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token punctuation">:</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>and (indirectly) in the <code>createOnEnter()</code> method in the App View:</p>
<div class="gatsby-highlight">
      <pre class="language-js"><code>app<span class="token punctuation">.</span>Todos<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">newAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>This calls the Collection.create() method, which (if we look at the <a href="http://backbonejs.org/docs/backbone.html#section-134">annotated code</a>), boths <code>add</code>s and <code>save</code>s a model.</p>
<p>In the <a href="http://unlikenesses.github.io/2015/12/17/backbone-todo-tutorial-part-two/">next tutorial</a> we'll be adding that functionality to the app, as well as the completion, closing, filtering, and ordering functions.</p></div></div><div class="related" data-reactid="33"><ul class="related-posts" data-reactid="34"><li data-reactid="35"><h3 data-reactid="36"><!-- react-text: 37 -->Previous<!-- /react-text --><!-- react-text: 38 -->:<!-- /react-text --><!-- react-text: 39 --> <!-- /react-text --><a href="/2015-10-22-tanking/" data-reactid="40"><!-- react-text: 41 -->tanking<!-- /react-text --><!-- react-text: 42 --> <!-- /react-text --><small data-reactid="43">22 October, 2015</small></a></h3></li><li data-reactid="44"><h3 data-reactid="45"><!-- react-text: 46 -->Next<!-- /react-text --><!-- react-text: 47 -->:<!-- /react-text --><!-- react-text: 48 --> <!-- /react-text --><a href="/2015-12-17-backbone-todo-tutorial-part-two/" data-reactid="49"><!-- react-text: 50 -->backbone todo tutorial part two<!-- /react-text --><!-- react-text: 51 --> <!-- /react-text --><small data-reactid="52">17 December, 2015</small></a></h3></li></ul></div></div></div></div></div></body></html>